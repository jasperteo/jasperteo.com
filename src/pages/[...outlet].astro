---
import RootLayout from "@/layouts/RootLayout.astro";
import AppLayout from "@/layouts/AppLayout.astro";
import HomepageOutlet from "@/components/HomepageOutlet.astro";
import ResumeOutlet from "@/components/ResumeOutlet.astro";

export const getStaticPaths = () => [
  { params: { outlet: undefined } },
  { params: { outlet: "resume" } },
];

const { outlet } = Astro.params;
const title = "Jasper Teo";
const description =
  "Hey there! I like crafting cool stuff for the web. Come explore and see what I'm up to!";
---

<script is:inline>
  const themeValues = ["dark", "light", "system"];
  const defaultTheme = "system";
  const storageKey = "theme";

  const useTheme = (document) => {
    let theme = localStorage.getItem(storageKey) ?? defaultTheme;
    if (theme !== "dark" && theme !== "light") {
      theme = window.matchMedia("(prefers-color-scheme: dark)").matches
        ? "dark"
        : "light";
    }
    document.documentElement.classList.remove(...themeValues);
    document.documentElement.classList.add(theme);
  };

  useTheme(document);

  document.addEventListener("astro:before-swap", (event) =>
    useTheme(event.newDocument)
  );
</script>

<RootLayout title={title} description={description}>
  <AppLayout slot="app">
    {outlet === undefined && <HomepageOutlet slot="outlet" />}
    {outlet === "resume" && <ResumeOutlet slot="outlet" />}
  </AppLayout>
</RootLayout>
